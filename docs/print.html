<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Pleroma</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="what-is-pleroma.html">What is Pleroma?</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="configuration.html"><strong aria-hidden="true">1.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="running.html"><strong aria-hidden="true">1.3.</strong> Running Pleroma</a></li></ol></li><li class="chapter-item expanded "><a href="allo.html"><strong aria-hidden="true">2.</strong> Allo</a></li><li class="chapter-item expanded "><a href="hylic.html"><strong aria-hidden="true">3.</strong> Hylic</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="hylic/basics.html"><strong aria-hidden="true">3.1.</strong> Basics</a></li><li class="chapter-item expanded "><a href="hylic/modules.html"><strong aria-hidden="true">3.2.</strong> Modules</a></li><li class="chapter-item expanded "><a href="hylic/messaging.html"><strong aria-hidden="true">3.3.</strong> Messaging, Entities, Vats</a></li><li class="chapter-item expanded "><a href="hylic/constraints.html"><strong aria-hidden="true">3.4.</strong> Entity Constraints</a></li><li class="chapter-item expanded "><a href="hylic/capabilities.html"><strong aria-hidden="true">3.5.</strong> Capabilities</a></li><li class="chapter-item expanded "><a href="hylic/alien.html"><strong aria-hidden="true">3.6.</strong> Alien Types</a></li><li class="chapter-item expanded "><a href="hylic/std.html"><strong aria-hidden="true">3.7.</strong> Std</a></li><li class="chapter-item expanded "><a href="hylic/distributed-primitives.html"><strong aria-hidden="true">3.8.</strong> Distributed Primitives</a></li></ol></li><li class="chapter-item expanded "><a href="pleroma.html"><strong aria-hidden="true">4.</strong> Pleroma</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pleroma/zeno-filesystem.html"><strong aria-hidden="true">4.1.</strong> Zeno Filesystem</a></li><li class="chapter-item expanded "><a href="pleroma/stores.html"><strong aria-hidden="true">4.2.</strong> Stores</a></li><li class="chapter-item expanded "><a href="pleroma/message-bus.html"><strong aria-hidden="true">4.3.</strong> Message Bus</a></li><li class="chapter-item expanded "><a href="pleroma/ingresses.html"><strong aria-hidden="true">4.4.</strong> Ingresses</a></li><li class="chapter-item expanded "><a href="pleroma/scheduling.html"><strong aria-hidden="true">4.5.</strong> Job Queue + Scheduler</a></li><li class="chapter-item expanded "><a href="pleroma/supervisor.html"><strong aria-hidden="true">4.6.</strong> Supervisor</a></li><li class="chapter-item expanded "><a href="pleroma/external-supervision.html"><strong aria-hidden="true">4.7.</strong> External Supervision, Containers</a></li></ol></li><li class="chapter-item expanded "><a href="charisma.html"><strong aria-hidden="true">5.</strong> Charisma</a></li><li class="chapter-item expanded "><a href="pleromic-software.html"><strong aria-hidden="true">6.</strong> Pleromic Software</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="erd-talk.html"><strong aria-hidden="true">6.1.</strong> erd-talk</a></li><li class="chapter-item expanded "><a href="hippie-science.html"><strong aria-hidden="true">6.2.</strong> hippie science</a></li><li class="chapter-item expanded "><a href="kokomoplux.html"><strong aria-hidden="true">6.3.</strong> kokomoplux</a></li><li class="chapter-item expanded "><a href="victory.html"><strong aria-hidden="true">6.4.</strong> victory</a></li></ol></li><li class="chapter-item expanded "><a href="everywhen.html"><strong aria-hidden="true">7.</strong> Everywhen</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Pleroma</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-pleroma"><a class="header" href="#what-is-pleroma">What is Pleroma?</a></h1>
<p>And what the bleep do we know?</p>
<p>Pleroma is a distributed, object-oriented operating system/VM inspired by the original vision of Alan Kay's Smalltalk, the E programming language, and Inferno/Plan9.</p>
<p>The creator or creators of Pleroma are entirely unknown - it is a found operating system.  The specification was discovered in a cache located in Oxyrhynchus, Egypt dating back to the 3rd century.</p>
<p>Pleroma is the answer to the following questions/problems:</p>
<ul>
<li>What happened to Smalltalk?</li>
<li>I want to host reliable internet services from multiple computers (some on my personal network, some on the cloud, some mobile), but Kuberenetes is too complex</li>
<li>Distributed software always ends up becoming centralized due to reliability</li>
<li>Why do I need Protobufs, API specs?</li>
<li>I feel unsafe downloading/running code from Github without reading it first</li>
<li>I have a lot of computing devices and no way to manage them uniformly</li>
<li>I need concurrency without all of the baggage</li>
<li>Actor systems are pointless without a strong distributed story</li>
<li>I don't want to know, or care, about where my software is running</li>
<li>Personal computing research has been completely stagnant, despite major technology advances in the last 50 years</li>
<li>I think that E/Plan9 were ahead of their time and/or interesting but ultimately useless</li>
<li>Using Erlang doesn't make me feel good inside, and I don't know why</li>
<li>I want to host my own email, but due to a laundry list of problems, that's not possible</li>
</ul>
<p>The four core components are:</p>
<ul>
<li><a href="./pleroma.html">Pleroma</a>: the actual operating system</li>
<li><a href="./hylic.html">Hylic</a>: a statically-typed language</li>
<li><a href="./allo.html">Allo</a>: the communication tool for interacting with Pleroma</li>
<li><a href="./charisma.html">Charisma</a>: a novel IDE integrating voice and AST editing</li>
</ul>
<p>Pleroma is versioned according to the solstices.  <code>w22</code> and <code>s22</code> referring to the winter and summer solstices of 2022, respectively.  Versions can't be patched unless there are major security issues, in which case one can append <code>p</code> and an incrementing number (e.g. <code>w22p4</code>).  Otherwise, a version is frozen in time and all new development takes place on the next solstice release.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<h2 id="docker-quickstart"><a class="header" href="#docker-quickstart">Docker Quickstart</a></h2>
<p>This requires the latest docker + docker compose to be installed, first.</p>
<pre><code>git clone https://github.com/wangell/pleroma
docker compose run pleroma
</code></pre>
<p>Once inside the container, run:</p>
<pre><code>./pleroma start
</code></pre>
<p>to run the &quot;Hello, world!&quot; example on a single-node cluster.</p>
<p>You're ready to start your Pleroma journey, continue to <a href="./allo.html">allo instructions</a>.</p>
<h2 id="manual-installation"><a class="header" href="#manual-installation">Manual Installation</a></h2>
<p>Install the prerequisites: <code>enet</code> and <code>libprotobuf</code>.  This can be achieved on Ubuntu by running</p>
<p><code>sudo apt-get install libenet7 libenet-dev protobuf-compiler libprotobuf-dev</code></p>
<p>Next, download by cloning the Git repository here:</p>
<pre><code>git clone https://github.com/wangell/pleroma
</code></pre>
<p>Ensure that your locale is UTF-8.  You can do this by adding the following to your .bashrc:</p>
<pre><code>export LANGUAGE=en_US.UTF-8
export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8
export LC_TYPE=en_US.UTF-8
</code></pre>
<p>Continue to the <a href="./installation.html">installation instructions</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started---installation"><a class="header" href="#getting-started---installation">Getting Started - Installation</a></h1>
<p>After cloning the repository and setting up your locale, follow the instructions for your specific architecture below:</p>
<h2 id="x86--x86_64"><a class="header" href="#x86--x86_64">x86 / x86_64</a></h2>
<pre><code>cd pleroma
./gen_make.sh
make
ln -s build/pleroma pleroma
ln -s build/allo allo
</code></pre>
<h2 id="risc-v"><a class="header" href="#risc-v">RISC V</a></h2>
<h2 id="arm"><a class="header" href="#arm">ARM</a></h2>
<h2 id="xenkvm"><a class="header" href="#xenkvm">Xen/KVM</a></h2>
<p>Continue to <a href="./configuration.html">configuration</a> to finish setting up your cluster.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started---configuration"><a class="header" href="#getting-started---configuration">Getting Started - Configuration</a></h1>
<p>Use a text editor to edit pleroma.yaml.</p>
<p>Assign a name and a network device for the cluster.</p>
<pre><code>---
name: bruno
netdev: tun0
</code></pre>
<p>Configure the resources that will be made available to the cluster:</p>
<pre><code>resources:
    - keyboard
    - monitor
    - mouse
    - gpu
</code></pre>
<p>Use tags to configure node-specific values that will be used during constraint satisfaction.</p>
<pre><code>tags:
    safe: ~
    stability-rating: 4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started---installation-1"><a class="header" href="#getting-started---installation-1">Getting Started - Installation</a></h1>
<p>Run Pleroma on the first node:</p>
<pre><code>pleroma
</code></pre>
<p>Run Pleroma on other nodes, specifying any accessible cluster IPs:</p>
<pre><code>pleroma -f 192.168.178.1
</code></pre>
<p>Pleroma can also automatically handle local discovery:</p>
<pre><code>pleroma --auto
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="allo"><a class="header" href="#allo">Allo</a></h1>
<p>Allo is a cluster-management and access tool for Pleroma.</p>
<p>Run <code>allo -g</code> for the visual mode.</p>
<p><code>allo nodes</code> will return a list of currently running nodes.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic"><a class="header" href="#hylic">Hylic</a></h1>
<p>Hylic is a statically-typed language for writing Pleroma entities/programs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---basics"><a class="header" href="#hylic---basics">Hylic - Basics</a></h1>
<pre><code>~sys

ε HelloWorld
	δ main(env: sys►Env) -&gt; u8
		loc a : u8 := 1 + 1
</code></pre>
<p>The line</p>
<pre><code>~sys
</code></pre>
<p>imports code from another module.</p>
<pre><code>ε HelloWorld
</code></pre>
<p>This line specifies an entity called HelloWorld.  Everything in Pleroma is an entity, except those things that aren't.
Every entity contains data and functions.  An entity specification is not an entity itself - just a blueprint.</p>
<pre><code>δ main(env: sys►Env) -&gt; u8
</code></pre>
<p>Says that there is a function <code>main</code>, that takes a variable <code>env</code> of type <code>sys.env</code> and returns an <code>int</code>.
The <code>δ</code> specifies the function as one with side-effects.  Alternatively, a <code>λ</code> specifies the function as pure.  Pure functions cannot perform side-effects.</p>
<pre><code>loc a : u8 := 1 + 1
</code></pre>
<p>Says to create a variable <code>a</code> of type <code>u8</code> and set its contents to <code>1 + 1</code>.  The type of <code>a</code> is a <code>loc u8</code>, further explained later in <a href="hylic/./hylic/messaging.html">Messaging, Entities, Vats</a>.  By default, all variables are local.  Local variables mean local to the entity.</p>
<h2 id="built-in-types"><a class="header" href="#built-in-types">Built-in Types</a></h2>
<p>Integer: u8, u16, u32, u64</p>
<p>Float: f32, f64</p>
<p>Boolean: bool (<code>#t</code>/<code>#f</code>)</p>
<p>Character: char (``a`)</p>
<p>String: str</p>
<h2 id="conditionals"><a class="header" href="#conditionals">Conditionals</a></h2>
<p>The match statement handles most conditionals in Pleroma:</p>
<pre><code>? 1 == 1
    #t
        io.print(&quot;Yes!&quot;)
    #f
        io.print(&quot;No!&quot;)
</code></pre>
<p>The empty lines can be left off in the case of only one statement:</p>
<pre><code>? 1 == 1
    #t io.print(&quot;Yes!&quot;)
    #f io.print(&quot;No!&quot;)
</code></pre>
<p>If no cases are given, an implied true match is inserted:</p>
<pre><code>? 1 == 1
    io.print(&quot;Yes!&quot;)
</code></pre>
<h2 id="control-flow"><a class="header" href="#control-flow">Control Flow</a></h2>
<p>For statements can be constructed with the pipe operator, similar to math:</p>
<pre><code>my-list : [u8] = [1, 2, 3, 4]

x | my-list
    do-something(x)
</code></pre>
<p>Indices can be extracted from the list by adding an additional variable <code>i, x | my-list</code></p>
<h2 id="return"><a class="header" href="#return">Return</a></h2>
<p>Use <code>↵</code> to return a value from a function.</p>
<h2 id="comments"><a class="header" href="#comments">Comments</a></h2>
<p>Comments can be added by surrounding a statement with <code>♦</code>.  Comments can be multi-line, too.</p>
<p><code>♦ This is a comment ♦</code></p>
<h2 id="casting"><a class="header" href="#casting">Casting</a></h2>
<pre><code>let q: u8 = 4

let z: s8 = as(q, s8)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---modules"><a class="header" href="#hylic---modules">Hylic - Modules</a></h1>
<p>Every file exists in a module, and modules are imported by path.</p>
<p>At the top of the file, you define your module <code>foo</code>.  No matter what, that module can always be accessed in all other files as <code>~foo</code>.  If you have multiple files with <code>foo</code>, then you can imagine all of them are concatenated together (no ordering).  Directory structure is ignored and replaced by whatever you specify.</p>
<h2 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h2>
<p>TBD</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---messaging"><a class="header" href="#hylic---messaging">Hylic - Messaging</a></h1>
<p>Messaging can be performed in many different ways in Hylic and is optionally restrictive.</p>
<p>All objects can be called synchronously, asynchronously, and via a Promise-based interface.</p>
<h2 id="synchronous-message-passing"><a class="header" href="#synchronous-message-passing">Synchronous Message Passing</a></h2>
<p>When we call an object synchronously, we wait for the response of the object before continuing.</p>
<pre><code>anObject.doThing()
</code></pre>
<h2 id="asynchronous-message-passing"><a class="header" href="#asynchronous-message-passing">Asynchronous Message Passing</a></h2>
<pre><code>anObject ! doThing
</code></pre>
<p>Passes a message and ignores the result.</p>
<h2 id="promises"><a class="header" href="#promises">Promises</a></h2>
<pre><code>myProm : @u8 := anObject ! doThing
</code></pre>
<p>Promises can be resolved using the resolution operator:</p>
<pre><code>@ promise-example
    # do something with the returned value, promise-example
    
@ let x : [@] = [more-promises1, more-promises2, more-promises3]
    # Resolve several promises
</code></pre>
<p>In this case, each promise variable is shadowed by the resolved version.</p>
<h2 id="vats"><a class="header" href="#vats">Vats</a></h2>
<p>Vats form local object-graphs (think: thread, think: process) - they execute parallel to eachother.  Every program starts in its own vat.  All objects created within that vat can be accessed via a regular function call, e.g. <code>myObject.doThis()</code>.  The function will then run synchronously.  To access objects outside of one's own vat, messaging must be used, e.g. <code>myObject ! doThis()</code> - which executes asynchronously.  Functions of objects within a vat can also be called asynchronously - but calls will not run parallely, only concurrently.  When a vat gets a message, it goes into a queue.  Each message is processed one by one.  One can think of a vat like a thread.</p>
<p>Use the following syntax to construct an object in a new vat:</p>
<pre><code>$anObject(1)
</code></pre>
<p>Constructing a new vat always returns the type <code>@ far object-type</code>, e.g.:</p>
<pre><code>myProm : @far anObject := $anObject()

@ myProm
    # The promise is resolved to a far anObject, we can send messages now
    myProm ! doThing
</code></pre>
<p>Alternatively, messages can be sent directly to the promise before resolution.  The messages will be preloaded in the message queue during vat formation.</p>
<pre><code>myProm : @far anObject := $anObject()

myProm ! doThing
</code></pre>
<h2 id="message-processing"><a class="header" href="#message-processing">Message Processing</a></h2>
<p>One of the key features of Pleroma is the ability to mix async and synchronous code.  It is important to understand this feature, as it is enabled by default: all code must yield or the vat will never receive messages.</p>
<p>To implement an infinite loop within a vat, one must use self-messaging:</p>
<pre><code>ε HelloWorld
	δ loop() -&gt; ()
        do-something()
        ! loop
</code></pre>
<p>Each entity also contains a variable <code>self</code>, which returns a reference to the current entity <code>self ! loop</code>.</p>
<h2 id="pure-objects"><a class="header" href="#pure-objects">Pure Objects</a></h2>
<p>Pure objects contain only pure functions and no data members.  They cannot be instantiated and are access via the Entity name.</p>
<pre><code>Ɵ HelloWorld
    λ add-world(hello-string: str)
        ↵ hello-string + &quot;, world!&quot;
</code></pre>
<p>And to call it from another entity, just use <code>HelloWorld.add-world(&quot;Hello&quot;)</code>.  No need to instantiate it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---entity-constraints"><a class="header" href="#hylic---entity-constraints">Hylic - Entity Constraints</a></h1>
<p>Entities can be configured to be scheduled according to constraints.  If an Entity is imported into a vat, the vat inherits the constraints.  Collisions between constraints must be handled manually.</p>
<p>Constraints consist of a list of either tags or boolean expressions.  A tag preceded by an &amp; operator will call the equivalent function.  A true boolean function/expression means that the object is able to be scheduled on a node.</p>
<pre><code>~sys►resources rsc
~sys►node nd

ε HelloWorld
    - nd.is(&quot;unixborn&quot;)
    - rsc.has(&quot;keyboard&quot;)
    - rsc.gt(&quot;monitors&quot;, 2)
    - boolean-callback boolean-collision
    - nd.each()

	δ boolean-callback(env: nd►Env) -&gt; bool
        ...
        ? rsc.present(&quot;keyboard&quot;)
            ↵ #t

</code></pre>
<p>Entity constraints marked with <code>-</code> form preambles - that is, they are executed within the kernel before object instantiation.  Preamble expressions don't have access to entity members.  They form an execution plan.</p>
<p>Entity constraints marked with <code>+</code> form postambles - which run after instantiation.  Postamble expressions have access to entity members.  Not everything can go according to plan, postambles react to and change previously made execution plans.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---capabilities"><a class="header" href="#hylic---capabilities">Hylic - Capabilities</a></h1>
<p>Objects in Pleroma can only be accessed/messaged by reference.  It's possible to make your objects accessible from the kernel and to guard them with ACLs.</p>
<p>Entities are able to access unique or node-unique system objects by adding an inoculation to the entity definition:</p>
<pre><code>~sys►monad
~sys►io

ε MyEntity {pinst : @far monad►Monad, io-ctx: @far io►Io}

  δ main(env: u8) -&gt; int
    let node-id : @u32 = pinst ! get-node-id()
    @ node-id
        ...

    io-ctx ! println(&quot;Testing, 1.2.3.&quot;)
</code></pre>
<p>During object instantiation, the kernel searches for node-unique and then unique objects (tagged in the preamble) until the type is matched.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---alien-types"><a class="header" href="#hylic---alien-types">Hylic - Alien Types</a></h1>
<p>One of the key features of Pleroma is the ability to interface with foreign clusters.</p>
<p>This can be achieved using the alien reference type <code>aln</code>.</p>
<pre><code>~wikipedia

ε HelloWorld
	δ main(env: sys.env) -&gt; u8
        aln wiki : wikipedia.Wikipedia = wikipedia.Wikipedia()

        wiki ! get-article-id(14985782)

</code></pre>
<p>This creates a messageable object reference, much like a far reference - except that a proxy object is instantiated in its place.  This ensures the safety + integrity of the cluster, while still allowing interfacing to foreign clusters/objects.  Say goodbye to API specs and Protobufs!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---std"><a class="header" href="#hylic---std">Hylic - Std</a></h1>
<h2 id="data-structures"><a class="header" href="#data-structures">Data structures</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hylic---distributed-primitives"><a class="header" href="#hylic---distributed-primitives">Hylic - Distributed Primitives</a></h1>
<h2 id="arc"><a class="header" href="#arc">ARC</a></h2>
<p>Entities outside of ones own vat behave similarly to heap-allocated memory - entities must be manually destroyed.  For that reason, a distributed automatic reference count object can be used to handle destruction of entities (a vat will automatically be destroyed when no more entities remain).</p>
<pre><code>~dis

...

dis.Arc.create($myObj)
</code></pre>
<h2 id="transactional--checkpoint"><a class="header" href="#transactional--checkpoint">Transactional / Checkpoint</a></h2>
<h2 id="crdts"><a class="header" href="#crdts">CRDTs</a></h2>
<h2 id="key-value-store"><a class="header" href="#key-value-store">Key-value Store</a></h2>
<h2 id="consistent-hashing"><a class="header" href="#consistent-hashing">Consistent Hashing</a></h2>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="zeno-filesystem"><a class="header" href="#zeno-filesystem">Zeno Filesystem</a></h1>
<p>Zeno is the distributed filesystem that powers Pleroma.  It is where all (most) system and user files are stored.</p>
<p>Two entity types power Zeno: <code>ZenoMaster</code> and <code>ZenoNode</code>.</p>
<p>Each node with a <code>storage</code> resource runs a ZenoNode entity, and a cluster-wide <code>ZenoMaster</code> entity runs on any regular node.</p>
<p>All files are stored as chunks spread across ZenoNodes, which are indexed by the ZenoMaster node.  The chunk size is tunable, but is set to a sane default.</p>
<p>Each chunk is replicated across 3 nodes (or however many <code>stable</code> nodes your system has).</p>
<h2 id="telescoping-tag-system"><a class="header" href="#telescoping-tag-system">Telescoping Tag System</a></h2>
<p>The primary difference in usability between a typical filesystem and Zeno, is that Zeno uses tags rather than paths.</p>
<p>On a typical filesystem, you might have a path called <code>System &gt; Programs &gt; ...</code> which lists all directories of every program.</p>
<p>In Zeno, files have a name, but directories don't exist.  Instead, every file has multiple tags, e.g.</p>
<p><code>filename: MyPhoto.jpg user: MyUser who: Will type: FamilyPhotos</code></p>
<p>and you can view these tags through a &quot;telescope&quot; or &quot;lens&quot;.  The lens allows you to change the structure of your files without affecting the underlying files.</p>
<p>Here's one example:</p>
<p>Let's say you wanted to see all your personal photos that contain you, and all your personal photos that contain Bob.  You could create two directories, one called &quot;Me&quot; and another called &quot;Bob&quot;, and copy and paste the photos into each directory.  There would be some duplication, as you and Bob are coworkers and appear in several photos together.</p>
<p>Alternatively, we could just add a tag <code>in-photo: Bob</code> or <code>in-photo: Will</code> to each photo (or you add both tags).  Now we can easily use a lens to achieve what we wanted:</p>
<p><code>Photos &gt; Bob:(in-photo:Bob), Me:(in-photo:Me), Together:(in-photo:Bob + in-photo:Me)</code></p>
<p>When viewed through this lens, you'll see a directory <code>Photos</code> that contains three other directories <code>Me</code>, <code>Bob</code>, and <code>Together</code>.  All photos tagged with <code>in-photo: Bob</code> will be placed in the Bob directory, etc.  No file duplication required.</p>
<p>By default, Pleroma provides a system lens, and a user lens that mimics what one might expect from a classic operating system.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p><code>~zeno</code></p>
<p><code>checkout(path: str, lens: Lens) -&gt; Zfile</code> - checks out and locks the current file.  It calls ZenoMaster, finds the location of the associated file chunks, assembles them by contacting each ZenoNode entity, and then returns the file.  You can specify what type of lock-access is required: multiple-reader, multiple-reader-single-writer, or exclusive.</p>
<p><code>look(lens: Lens)</code> - Takes a lens pattern and returns the associated file view.</p>
<h2 id="capabilities"><a class="header" href="#capabilities">Capabilities</a></h2>
<p>Programs are namespaced to their own tag (with the right capabilities).  Programs naturally cannot see anything outside of their own tag, unless they specifically request it via another capability.</p>
<h1 id="local-filesystem"><a class="header" href="#local-filesystem">Local Filesystem</a></h1>
<p>Local filesystems can still be accessed as normal using <code>~fs</code>, but it is discouraged unless absolutely necessary.</p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="pleromic-software"><a class="header" href="#pleromic-software">Pleromic Software</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erd-talk"><a class="header" href="#erd-talk">Erd-talk</a></h1>
<p>Erd-talk is a web-of-trust/reputation system for URIs.</p>
<ol>
<li>URIs can be assigned key/values, e.g. &quot;example.com:trust:1.0&quot;</li>
<li>You can query friendly erd-talk clusters for their values and compute against them, e.g. &quot;Gather all the trust values from friends about URI x and return the average&quot;</li>
<li>You can handle queries in a custom way.  Instead of just returning a value, you can compute, or recursively (via friendly clusters) compute, a new value.</li>
</ol>
<p>What can erd-talk be used for?</p>
<ul>
<li>Reweight Amazon/Yelp reviews according to your friends/family.</li>
<li>Discover new or interesting websites</li>
<li>Help decide whether a program/website/business is trustworthy or not</li>
<li>Calculate impact scores of papers independent of publishers</li>
<li>Find inaccuracies in news stories</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hippie-science"><a class="header" href="#hippie-science">hippie science</a></h1>
<p>Voice control software that interfaces with all parts of Pleroma.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kokomoplux"><a class="header" href="#kokomoplux">kokomoplux</a></h1>
<p>Inter-cluster chat program.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="victory"><a class="header" href="#victory">victory</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="everywhen"><a class="header" href="#everywhen">Everywhen</a></h1>
<p>These serve as the inspiration and basis for Pleroma</p>
<ul>
<li><a href="http://www.erights.org/">E Programming Language</a></li>
<li><a href="https://dl.acm.org/doi/pdf/10.1145/358896.358899">Notation as a Tool of Thought</a></li>
<li><a href="https://www.youtube.com/watch?v=oKg1hTOQXoY">Alan Kay: The computer revolution hasn't happened yet</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
